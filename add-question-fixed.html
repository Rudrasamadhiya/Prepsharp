<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Question - PrepSharp</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div>
            <h2>PrepSharp - Add Question</h2>
            <h3 id="paper-name" style="margin-top: 5px; color: #666; font-size: 16px;"></h3>
        </div>
        <div>
            <button id="pdf-btn" class="btn" style="background-color: #4caf50; margin-right: 10px;">Upload PDF</button>
            <button id="summary-btn" class="btn secondary">View Summary</button>
            <button id="dashboard-btn" class="btn">Dashboard</button>
        </div>
    </header>
    
    <div class="container">
        <div class="card">
            <div class="progress-bar">
                <div class="progress" id="progress-bar"></div>
            </div>
            
            <h2 id="question-counter">Question 1 of 30</h2>
            <h3 id="current-subject">Physics</h3>
            
            <div class="form-group">
                <label for="question-type">Question Type</label>
                <select id="question-type" required>
                    <option value="scq">Single Correct Option (SCQ) [+4, -1]</option>
                    <option value="integer">Integer Type (Numerical) [+4, -1]</option>
                </select>
                <div id="marking-info" class="marking-info"></div>
            </div>
            
            <div class="form-group">
                <label for="question-text">Question Text</label>
                <textarea id="question-text" rows="4" required></textarea>
                <button id="capture-question-btn" class="upload-btn">Capture from PDF</button>
                <div id="question-image-container" class="image-container hidden">
                    <img id="question-image" src="" alt="Question Image">
                    <button class="remove-btn" id="remove-question-image">×</button>
                </div>
            </div>
            
            <div id="options-container" class="form-group">
                <!-- Options content -->
            </div>
            
            <div id="integer-answer" class="form-group hidden">
                <label for="integer-value">Correct Answer (0-99)</label>
                <input type="number" id="integer-value" min="0" max="99">
            </div>
            
            <div class="form-group">
                <label for="explanation">Explanation (Optional)</label>
                <textarea id="explanation" rows="3"></textarea>
                <button id="capture-explanation-btn" class="upload-btn">Capture from PDF</button>
                <div id="explanation-image-container" class="image-container hidden">
                    <img id="explanation-image" src="" alt="Explanation Image">
                    <button class="remove-btn" id="remove-explanation-image">×</button>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between;">
                <button id="prev-question" class="btn secondary">Previous</button>
                <button id="next-question" class="btn">Next</button>
            </div>
        </div>
    </div>

    <script src="html2canvas.min.js"></script>
    <script src="fixed-update-paper-name.js"></script>
    <script>
        // Check if exam data exists
        let examData;
        try {
            const storedData = localStorage.getItem('currentExam');
            if (storedData) {
                examData = JSON.parse(storedData);
                console.log('Loaded exam data:', examData);
                
                // Ensure questions array exists
                if (!examData.questions) {
                    console.log('Creating questions array');
                    examData.questions = [];
                }
            } else {
                examData = {
                    subjects: ['physics'],
                    subjectDetails: { physics: { questionCount: 30 } },
                    totalQuestions: 30,
                    questions: []
                };
                console.log('Created default exam data');
            }
        } catch (error) {
            console.error('Error parsing exam data:', error);
            examData = {
                subjects: ['physics'],
                subjectDetails: { physics: { questionCount: 30 } },
                totalQuestions: 30,
                questions: []
            };
        }
        
        // Update paper name in header
        try {
            updatePaperName();
            console.log('Paper name updated');
        } catch (error) {
            console.error('Error updating paper name:', error);
        }
        
        // Rest of your JavaScript code
    </script>
</body>
</html>
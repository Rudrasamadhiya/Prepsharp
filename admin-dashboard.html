<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - PrepSharp</title>
    <style>
        :root {
            --primary-color: #1976d2;
            --secondary-color: #42a5f5;
            --accent-color: #ff9800;
            --background-color: #f5f5f5;
            --text-color: #212121;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            align-items: center;
        }
        .logo {
            width: 40px;
            height: 40px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
        .admin-badge {
            background-color: #ff5722;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 10px;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }
        .btn.primary { background-color: var(--primary-color); color: white; }
        .btn.accent { background-color: var(--accent-color); color: white; }
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }
        h1, h2, h3 { color: var(--primary-color); }
        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .action-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .action-card:hover {
            transform: translateY(-5px);
        }
        .action-icon {
            height: 120px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: var(--primary-color);
        }
        .action-info {
            padding: 15px;
        }
        .action-info h3 {
            margin-top: 0;
        }
        .exam-list {
            margin-top: 20px;
        }
        .exam-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .exam-item:last-child {
            border-bottom: none;
        }
        .exam-info h3 {
            margin: 0 0 5px 0;
        }
        .exam-info p {
            margin: 0;
            color: #666;
        }
        .exam-actions {
            display: flex;
            gap: 10px;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-container">
            <img src="prepsharp-logo.png" alt="PrepSharp Logo" style="height: 40px; margin-right: 10px;">
            <h2>PrepSharp <span class="admin-badge">ADMIN</span></h2>
        </div>
        <div class="user-info">
            <span>Welcome, Admin</span>
            <button id="logout-btn" class="btn primary">Logout</button>
        </div>
    </header>
    
    <div class="container">
        <div class="card">
            <h1>Admin Dashboard</h1>
            <p>Manage exam papers and user data</p>
            
            <div class="admin-actions">
                <div class="action-card" onclick="window.location.href='add-exam.html'">
                    <div class="action-icon">+</div>
                    <div class="action-info">
                        <h3>Create New Exam</h3>
                        <p>Add a new exam paper</p>
                    </div>
                </div>
                
                <div class="action-card" onclick="window.location.href='manage-exams.html'">
                    <div class="action-icon">üìù</div>
                    <div class="action-info">
                        <h3>Manage Exams</h3>
                        <p>Edit or delete existing exams</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>Recent Exams</h2>
            <div id="recent-exams" class="exam-list">
                <!-- Recent exams will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Check if admin is logged in
        if (!localStorage.getItem('adminLoggedIn')) {
            window.location.href = 'admin-login.html';
        }
        
        // Load recent exams
        const recentExams = document.getElementById('recent-exams');
        const exams = JSON.parse(localStorage.getItem('exams') || '{}');
        
        // Convert to array and sort by creation date
        const examArray = Object.entries(exams).map(([id, exam]) => ({id, ...exam}))
            .sort((a, b) => {
                const dateA = a.createdAt ? new Date(a.createdAt) : new Date(0);
                const dateB = b.createdAt ? new Date(b.createdAt) : new Date(0);
                return dateB - dateA;
            })
            .slice(0, 5); // Get only the 5 most recent
        
        if (examArray.length === 0) {
            recentExams.innerHTML = '<p>No exams created yet.</p>';
        } else {
            recentExams.innerHTML = '';
            
            const examTitles = {
                'jee-advanced': 'JEE Advanced',
                'jee-main': 'JEE Main',
                'neet': 'NEET',
                'bitsat': 'BITSAT'
            };
            
            examArray.forEach(exam => {
                let examTitle = examTitles[exam.type] || exam.type;
                if (exam.type === 'jee-advanced' && exam.paperNumber) {
                    examTitle += ` Paper ${exam.paperNumber}`;
                }
                
                const examItem = document.createElement('div');
                examItem.className = 'exam-item';
                examItem.innerHTML = `
                    <div class="exam-info">
                        <h3>${examTitle} ${exam.year}</h3>
                        <p>${exam.totalQuestions} questions | ${exam.subjects.map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(', ')}</p>
                    </div>
                    <div class="exam-actions">
                        <button class="btn primary edit-btn" data-id="${exam.id}">Edit</button>
                    </div>
                `;
                
                recentExams.appendChild(examItem);
                
                // Add event listener for edit button
                examItem.querySelector('.edit-btn').addEventListener('click', function() {
                    const examId = this.getAttribute('data-id');
                    editExam(examId);
                });
            });
        }
        
        // Edit exam function
        function editExam(examId) {
            const exams = JSON.parse(localStorage.getItem('exams') || '{}');
            const exam = exams[examId];
            
            if (exam) {
                // Set as current exam
                localStorage.setItem('currentExam', JSON.stringify(exam));
                localStorage.setItem('currentQuestionIndex', '0');
                localStorage.setItem('currentSubject', exam.subjects[0]);
                
                if (exam.type === 'jee-advanced') {
                    localStorage.setItem('currentSection', '0');
                    window.location.href = 'add-question-advanced.html';
                } else {
                    window.location.href = 'add-question.html';
                }
            }
        }
        
        // Logout functionality
        document.getElementById('logout-btn').addEventListener('click', function() {
            localStorage.removeItem('adminLoggedIn');
            window.location.href = 'admin-login.html';
        });
    </script>
</body>
</html>
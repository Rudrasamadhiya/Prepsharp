<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Creator</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .step { display: none; margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .active { display: block; }
        button { padding: 8px 15px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
        input, select { padding: 8px; margin: 5px 0; width: 100%; box-sizing: border-box; }
        .checkbox-group { margin: 10px 0; }
        #pdfViewer { width: 100%; height: 600px; border: 1px solid #ddd; margin: 10px 0; }
        #instructions { background-color: #f8f9fa; padding: 10px; border-left: 4px solid #4CAF50; }
    </style>
</head>
<body>
    <h1>Paper Creator Tool</h1>
    
    <!-- Step 1: Basic Info -->
    <div id="step1" class="step active">
        <h2>Step 1: Paper Information</h2>
        <div>
            <label for="paperName">Paper Name (e.g., 2024-2):</label>
            <input type="text" id="paperName" placeholder="Enter paper name">
        </div>
        <div>
            <label for="pdfFile">Select PDF File:</label>
            <input type="file" id="pdfFile" accept="application/pdf">
        </div>
        <button id="nextToStep2">Next</button>
    </div>
    
    <!-- Step 2: Questions per Subject -->
    <div id="step2" class="step">
        <h2>Step 2: Questions per Subject</h2>
        <div>
            <label for="chemistryQuestions">Number of Chemistry Questions:</label>
            <input type="number" id="chemistryQuestions" min="1" value="17">
        </div>
        <div>
            <label for="mathsQuestions">Number of Maths Questions:</label>
            <input type="number" id="mathsQuestions" min="1" value="17">
        </div>
        <div>
            <label for="physicsQuestions">Number of Physics Questions:</label>
            <input type="number" id="physicsQuestions" min="1" value="17">
        </div>
        <button id="nextToStep3">Next</button>
    </div>
    
    <!-- Step 3: Questions with Options -->
    <div id="step3" class="step">
        <h2>Step 3: Questions with Options</h2>
        <div id="optionsContainer">
            <!-- Will be populated dynamically -->
        </div>
        <button id="nextToStep4">Next</button>
    </div>
    
    <!-- Step 4: Take Screenshots -->
    <div id="step4" class="step">
        <h2>Step 4: Take Screenshots</h2>
        <div id="instructions">
            <p><strong>Instructions:</strong></p>
            <ol>
                <li>Navigate through the PDF using the controls below</li>
                <li>For each question/option, position the PDF to show the content clearly</li>
                <li>Click the "Take Screenshot" button to capture the current view</li>
                <li>Save the screenshot to the correct folder with the suggested filename</li>
                <li>Continue until all questions and options are captured</li>
            </ol>
        </div>
        
        <div>
            <label for="currentSubject">Current Subject:</label>
            <select id="currentSubject">
                <option value="Chemistry">Chemistry</option>
                <option value="Maths">Maths</option>
                <option value="Physics">Physics</option>
            </select>
        </div>
        
        <div>
            <label for="currentQuestion">Current Question:</label>
            <select id="currentQuestion"></select>
        </div>
        
        <div>
            <label for="captureType">Capture Type:</label>
            <select id="captureType">
                <option value="question">Question</option>
                <option value="option1">Option 1</option>
                <option value="option2">Option 2</option>
                <option value="option3">Option 3</option>
                <option value="option4">Option 4</option>
            </select>
        </div>
        
        <div>
            <embed id="pdfViewer" type="application/pdf" src="">
        </div>
        
        <div>
            <button id="takeScreenshot">Take Screenshot</button>
            <p id="saveInstructions"></p>
        </div>
        
        <div>
            <button id="nextItem">Next Item</button>
            <button id="finish">Finish</button>
        </div>
    </div>
    
    <script>
        // Global variables
        let paperData = {
            name: '',
            subjects: {
                Chemistry: { questions: 0, withOptions: [] },
                Maths: { questions: 0, withOptions: [] },
                Physics: { questions: 0, withOptions: [] }
            },
            pdfUrl: ''
        };
        
        let currentState = {
            subject: 'Chemistry',
            question: 1,
            captureType: 'question'
        };
        
        // Step 1: Basic Info
        document.getElementById('nextToStep2').addEventListener('click', function() {
            const paperName = document.getElementById('paperName').value.trim();
            const pdfFile = document.getElementById('pdfFile').files[0];
            
            if (!paperName) {
                alert('Please enter a paper name');
                return;
            }
            
            if (!pdfFile) {
                alert('Please select a PDF file');
                return;
            }
            
            paperData.name = paperName;
            paperData.pdfUrl = URL.createObjectURL(pdfFile);
            
            // Move to step 2
            document.getElementById('step1').classList.remove('active');
            document.getElementById('step2').classList.add('active');
        });
        
        // Step 2: Questions per Subject
        document.getElementById('nextToStep3').addEventListener('click', function() {
            const chemistryQuestions = parseInt(document.getElementById('chemistryQuestions').value);
            const mathsQuestions = parseInt(document.getElementById('mathsQuestions').value);
            const physicsQuestions = parseInt(document.getElementById('physicsQuestions').value);
            
            if (isNaN(chemistryQuestions) || isNaN(mathsQuestions) || isNaN(physicsQuestions) ||
                chemistryQuestions < 1 || mathsQuestions < 1 || physicsQuestions < 1) {
                alert('Please enter valid numbers for questions');
                return;
            }
            
            paperData.subjects.Chemistry.questions = chemistryQuestions;
            paperData.subjects.Maths.questions = mathsQuestions;
            paperData.subjects.Physics.questions = physicsQuestions;
            
            // Generate options UI for step 3
            generateOptionsUI();
            
            // Move to step 3
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step3').classList.add('active');
        });
        
        // Generate options UI for step 3
        function generateOptionsUI() {
            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';
            
            for (const subject in paperData.subjects) {
                const subjectDiv = document.createElement('div');
                subjectDiv.innerHTML = `<h3>${subject}</h3>`;
                
                const questionsWithOptions = document.createElement('div');
                questionsWithOptions.innerHTML = '<p>Select questions that have options:</p>';
                
                for (let i = 1; i <= paperData.subjects[subject].questions; i++) {
                    const checkboxDiv = document.createElement('div');
                    checkboxDiv.className = 'checkbox-group';
                    
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = `${subject}-q${i}`;
                    checkbox.value = i;
                    
                    // Default: questions 1-7 and 14-17 have options
                    if (i <= 7 || i >= 14) {
                        checkbox.checked = true;
                    }
                    
                    const label = document.createElement('label');
                    label.htmlFor = `${subject}-q${i}`;
                    label.textContent = `Question ${i}`;
                    
                    checkboxDiv.appendChild(checkbox);
                    checkboxDiv.appendChild(label);
                    questionsWithOptions.appendChild(checkboxDiv);
                }
                
                subjectDiv.appendChild(questionsWithOptions);
                container.appendChild(subjectDiv);
            }
        }
        
        // Step 3: Questions with Options
        document.getElementById('nextToStep4').addEventListener('click', function() {
            // Save which questions have options
            for (const subject in paperData.subjects) {
                paperData.subjects[subject].withOptions = [];
                
                for (let i = 1; i <= paperData.subjects[subject].questions; i++) {
                    const checkbox = document.getElementById(`${subject}-q${i}`);
                    if (checkbox && checkbox.checked) {
                        paperData.subjects[subject].withOptions.push(i);
                    }
                }
            }
            
            // Setup PDF viewer
            document.getElementById('pdfViewer').src = paperData.pdfUrl;
            
            // Setup question dropdown
            updateQuestionDropdown();
            
            // Update save instructions
            updateSaveInstructions();
            
            // Move to step 4
            document.getElementById('step3').classList.remove('active');
            document.getElementById('step4').classList.add('active');
        });
        
        // Update question dropdown based on current subject
        function updateQuestionDropdown() {
            const dropdown = document.getElementById('currentQuestion');
            dropdown.innerHTML = '';
            
            const subject = document.getElementById('currentSubject').value;
            const questionCount = paperData.subjects[subject].questions;
            
            for (let i = 1; i <= questionCount; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `Question ${i}`;
                dropdown.appendChild(option);
            }
            
            // Set current question
            dropdown.value = currentState.question;
            
            // Update capture type options
            updateCaptureTypeOptions();
        }
        
        // Update capture type options based on current question
        function updateCaptureTypeOptions() {
            const dropdown = document.getElementById('captureType');
            const subject = currentState.subject;
            const question = currentState.question;
            
            // Check if this question has options
            const hasOptions = paperData.subjects[subject].withOptions.includes(parseInt(question));
            
            // Enable/disable option selections
            const optionElements = dropdown.querySelectorAll('option[value^="option"]');
            optionElements.forEach(opt => {
                opt.disabled = !hasOptions;
            });
            
            // If current selection is an option but question doesn't have options, switch to question
            if (currentState.captureType.startsWith('option') && !hasOptions) {
                dropdown.value = 'question';
                currentState.captureType = 'question';
            }
            
            // Update save instructions
            updateSaveInstructions();
        }
        
        // Update save instructions
        function updateSaveInstructions() {
            const subject = currentState.subject;
            const question = currentState.question;
            const captureType = currentState.captureType;
            
            let filename;
            if (captureType === 'question') {
                filename = `Question-${question}.png`;
            } else {
                const optionNum = captureType.replace('option', '');
                filename = `Question-${question} Option-${optionNum}.png`;
            }
            
            const path = `C:\\Users\\HP\\myproject\\jeeapp\\src\\webapp\\Prepsharp\\papers\\${paperData.name}\\${subject}\\${filename}`;
            
            document.getElementById('saveInstructions').innerHTML = `
                <strong>Save screenshot as:</strong><br>
                ${path}
            `;
        }
        
        // Event listeners for step 4
        document.getElementById('currentSubject').addEventListener('change', function() {
            currentState.subject = this.value;
            currentState.question = 1;
            updateQuestionDropdown();
        });
        
        document.getElementById('currentQuestion').addEventListener('change', function() {
            currentState.question = this.value;
            updateCaptureTypeOptions();
        });
        
        document.getElementById('captureType').addEventListener('change', function() {
            currentState.captureType = this.value;
            updateSaveInstructions();
        });
        
        document.getElementById('takeScreenshot').addEventListener('click', function() {
            alert('Please take a screenshot now (using your system screenshot tool) and save it with the filename shown below.');
        });
        
        document.getElementById('nextItem').addEventListener('click', function() {
            const subject = currentState.subject;
            const question = parseInt(currentState.question);
            const captureType = currentState.captureType;
            const hasOptions = paperData.subjects[subject].withOptions.includes(question);
            
            // Logic to move to next item
            if (captureType === 'question' && hasOptions) {
                // Move to option 1
                currentState.captureType = 'option1';
            } else if (captureType === 'option1') {
                // Move to option 2
                currentState.captureType = 'option2';
            } else if (captureType === 'option2') {
                // Move to option 3
                currentState.captureType = 'option3';
            } else if (captureType === 'option3') {
                // Move to option 4
                currentState.captureType = 'option4';
            } else {
                // Move to next question or subject
                if (question < paperData.subjects[subject].questions) {
                    // Next question
                    currentState.question = question + 1;
                    currentState.captureType = 'question';
                } else {
                    // Next subject
                    if (subject === 'Chemistry') {
                        currentState.subject = 'Maths';
                        currentState.question = 1;
                        currentState.captureType = 'question';
                    } else if (subject === 'Maths') {
                        currentState.subject = 'Physics';
                        currentState.question = 1;
                        currentState.captureType = 'question';
                    } else {
                        // Finished all subjects
                        alert('You have completed all items!');
                    }
                }
            }
            
            // Update UI
            document.getElementById('currentSubject').value = currentState.subject;
            updateQuestionDropdown();
            document.getElementById('captureType').value = currentState.captureType;
            updateSaveInstructions();
        });
        
        document.getElementById('finish').addEventListener('click', function() {
            alert('Paper creation process completed! All screenshots should be saved in the appropriate folders.');
        });
    </script>
</body>
</html>
// Fix for capture and remove buttons
window.onload = function() {
    // Hide loading message
    document.getElementById('loading-container').style.display = 'none';
    document.getElementById('add-question-form').style.display = 'block';
    
    // PDF upload button
    document.getElementById('pdf-btn').onclick = function() {
        // Create a file input element
        var fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = 'application/pdf';
        
        // When a file is selected
        fileInput.onchange = function() {
            if (fileInput.files.length > 0) {
                // Change the button appearance
                var pdfBtn = document.getElementById('pdf-btn');
                pdfBtn.innerHTML = '<i class="fas fa-check me-1"></i> PDF Uploaded';
                pdfBtn.classList.remove('btn-success');
                pdfBtn.classList.add('btn-secondary');
                pdfBtn.disabled = true;
                window.pdfUploaded = true;
            }
        };
        
        // Trigger the file selection dialog
        fileInput.click();
    };
    
    // Capture question button
    var captureQuestionBtn = document.getElementById('capture-question-btn');
    if (captureQuestionBtn) {
        captureQuestionBtn.addEventListener('click', function() {
            if (!window.pdfUploaded) {
                alert('Please upload a PDF first');
                return;
            }
            
            // Hide question text
            document.getElementById('question-text').style.display = 'none';
            
            // Show blue box instead
            var img = document.getElementById('question-image-preview-img');
            img.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAEsCAYAAADtt+XCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhPSURBVHhe7dzBbttGFIZRJ0WB7rLo+z9YF+2uQAuXiUeWZUq2JQ7Jfw7OJgVsUuYHfDP06P39/eMAYJQAAUhOTk7+87/X19ePVwDfiwABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAAJLD4eEfNmA43BmH9z8AAAAASUVORK5CYII=';
            document.getElementById('question-image-preview').style.display = 'block';
        });
    }
    
    // Option capture buttons
    var optionButtons = document.querySelectorAll('.option-capture-btn');
    for (var i = 0; i < optionButtons.length; i++) {
        optionButtons[i].addEventListener('click', function() {
            if (!window.pdfUploaded) {
                alert('Please upload a PDF first');
                return;
            }
            
            var option = this.getAttribute('data-option');
            document.getElementById('option-' + option + '-text').style.display = 'none';
            
            var img = document.getElementById('option-' + option + '-image-preview-img');
            img.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAEsCAYAAADtt+XCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhPSURBVHhe7dzBbttGFIZRJ0WB7rLo+z9YF+2uQAuXiUeWZUq2JQ7Jfw7OJgVsUuYHfDP06P39/eMAYJQAAUhOTk7+87/X19ePVwDfiwABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAABIBApAIEIBEgAAkAgQgESAAiQABSAQIQCJAAJLD4eEfNmA43BmH9z8AAAAASUVORK5CYII=';
            document.getElementById('option-' + option + '-image-preview').style.display = 'block';
        });
    }
    
    // Remove question image button
    var removeQuestionBtn = document.querySelector('button[onclick="removeQuestionImage()"]');
    if (removeQuestionBtn) {
        removeQuestionBtn.addEventListener('click', function() {
            document.getElementById('question-image-preview').style.display = 'none';
            document.getElementById('question-text').style.display = 'block';
        });
    }
    
    // Remove option image buttons
    var removeOptionBtns = document.querySelectorAll('button[onclick^="removeOptionImage"]');
    for (var i = 0; i < removeOptionBtns.length; i++) {
        removeOptionBtns[i].addEventListener('click', function() {
            var option = this.getAttribute('onclick').match(/'([a-d])'/)[1];
            document.getElementById('option-' + option + '-image-preview').style.display = 'none';
            document.getElementById('option-' + option + '-text').style.display = 'block';
        });
    }
};